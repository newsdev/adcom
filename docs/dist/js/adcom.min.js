+function(a){"use strict";function b(c){var e=Array.prototype.slice.call(arguments,b.length);return this.each(function(){var b=a(this),f=b.data("adcom.index");"object"==typeof c&&c&&f&&(f=!1);var g=a.extend({},d.DEFAULTS,b.data(),f&&f.options,"object"==typeof c&&c);f||b.data("adcom.index",f=new d(this,g)),"string"==typeof c?f[c].apply(f,e):g.show&&!g.remote&&f.show()})}function c(b,c){return a.makeArray(b).concat(a.makeArray(a(b).parents())).reduce(function(b,d){return b?b:a(d).data(c)?a(d):void 0},null)}var d=function(b,c){var d=this;this.options=c,this.$element=a(b),this.$items="string"==typeof this.options.items?JSON.parse(this.options.items):this.options.items,this.template=this.parseTemplate(this.options.template),this.states="string"===this.options.states?this.options.states.split(/,\s*/):this.options.states||[],this.rendered=[],this.sort=null,this.filters={},this.currentPage=parseInt(this.options.currentPage||1),this.pageSize=parseInt(this.options.pageSize||1),this.setInitialState(),this.options.remote&&a.getJSON(this.options.remote,function(b){d.$items=b,d.options.show&&d.show(),d.$element.trigger(a.Event("loaded.adcom.index",{items:b}))})};d.VERSION="0.1.0",d.EVENTS=a.map("scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave load resize scroll unload error keydown keypress keyup load resize scroll unload error blur focus focusin focusout change select submit".split(" "),function(a){return a+".adcom.index.data-api"}).join(" "),d.DEFAULTS={show:!0,items:[],states:[],selectedClass:"",filtering:"on",sorting:"on",pagination:"off",currentPage:1,pageSize:20},d.prototype.show=function(){var b=this;b.$element.trigger("show.adcom.index");var c=b.getCurrentItems();a(b.$element).empty(),b.rendered=[],a.each(c,function(c,d){var e=b.renderItem(d);a(b.$element).append(e)}),b.$element.trigger(a.Event("shown.adcom.index",{items:c}))},d.prototype.select=function(b){var c=this;b=a.map([b],function(a){return a}),a(b).each(function(a,b){c.changeState(b,!0)})},d.prototype.deselect=function(b){var c=this;b=a.map([b],function(a){return a}),a(b).each(function(a,b){c.changeState(b,!1)})},d.prototype.toggle=function(b){var c=this;b=a.map([b],function(a){return a}),a(b).each(function(b,d){var b="number"==typeof d?d:a(d).data("adcom.index.idx");c.changeState(d,c.states[b]?!1:!0)})},d.prototype.changeState=function(b,c){if("number"==typeof b)var d=this.$items[b],e=b,f=this.rendered[e];else var f=a(b),d=f.data("adcom.index.item"),e=f.data("adcom.index.idx");this.$element.trigger(a.Event("toggle.adcom.index",{item:d,target:f,index:e,state:c})),this.states[e]=c,c?f.addClass(this.options.selectedClass):f.removeClass(this.options.selectedClass),this.$element.trigger(a.Event("toggled.adcom.index",{item:d,target:f,index:e,state:c}))},d.prototype.getSelected=function(){var b=[],c=this;return a.each(this.$items,function(a,d){c.states[a]&&b.push(d)}),b},d.prototype.setInitialState=function(){var b=this;this.toggleFilter(a(".active[data-filter][data-target]")),a("[data-sort]").each(function(){var c=a(this);if(a(c.data("target"))[0]==b.$element[0]){var d=c.data("sort");c.hasClass("sort-ascending")&&b.setSort(d,!1),c.hasClass("sort-descending")&&b.setSort(d,!0)}})},d.prototype.parseTemplate=function(a){return"function"==typeof a?a:"string"==typeof a?this.compileTemplate(a):this.options.fields?this.defaultTemplate():this.compileTemplate(this.$element.html())},d.prototype.compileTemplate=function(a){return this.options.templateEngine?this.options.templateEngine(a):function(){return a}},d.prototype.defaultTemplate=function(){var b="string"==typeof this.options.fields?this.options.fields.split(/,\s*/):this.options.fields,c="";return a.each(b,function(a,b){c+='<td data-field="'+b+'"></td>'}),c="<tr>"+c+"</tr>",this.compileTemplate(c)},d.prototype.getSort=function(a,b){var c=b?-1:1;return null===a||void 0===a?null:"function"==typeof a?function(b,d){return a(b,d)*c}:function(b,d){var e=("function"==typeof b[a]?b[a]():b[a])||"",f=("function"==typeof d[a]?d[a]():d[a])||"";return f>e?-1*c:e>f?1*c:0}},d.prototype.getFilter=function(b,c){if("function"==typeof c||void 0===c)return c;var d="string"==typeof b?b.split(/,\s*/):b;return d=a.isArray(d)?d:[d],function(b){var e=!1,f=null===d;return c=c.toLowerCase(),a.each(b,function(a){if(!e&&(f||d.indexOf(a)>-1)){var g="function"==typeof b[a]?b[a]():b[a];String(g).toLowerCase().indexOf(c)>-1&&(e=!0)}}),e}},d.prototype.setSort=function(b,c){this.$element.trigger(a.Event("sortChange.adcom.index",{})),this.sort=this.getSort(b,c),this.currentPage=1,this.$element.trigger(a.Event("sortChanged.adcom.index",{"function":this.sort}))},d.prototype.setFilter=function(b,c){this.$element.trigger(a.Event("filterChange.adcom.index",{key:b})),void 0===c?delete this.filters[b]:this.filters[b]=this.getFilter(b,c),this.currentPage=1,this.$element.trigger(a.Event("filterChanged.adcom.index",{key:b,"function":c}))},d.prototype.setCurrentPage=function(b){this.$element.trigger(a.Event("pageChange.adcom.index",{})),this.currentPage=parseInt(b),this.$element.trigger(a.Event("pageChanged.adcom.index",{page:this.currentPage}))},d.prototype.page=function(a){this.setCurrentPage(a),this.show()},d.prototype.getCurrentItems=function(){var a=this.$items.slice(0);return"on"==this.options.filtering&&(a=this.getFilteredItems(a)),"on"==this.options.sorting&&(a=this.getSortedItems(a)),"on"==this.options.pagination&&(a=this.getPaginatedItems(a)),a},d.prototype.getFilteredItems=function(b){var c=this;if(!a.isEmptyObject(this.filters)){var d=[];return a.each(b,function(b,e){var f=!0;a.each(c.filters,function(a,b){f&&b(e)||(f=!1)}),f&&d.push(e)}),d}return b},d.prototype.getSortedItems=function(a){return this.sort?a.sort(this.sort):a},d.prototype.getPaginatedItems=function(b){var c=b.length,d=Math.ceil(c/this.pageSize),e=(this.currentPage-1)*this.pageSize,f=e+this.pageSize,g=Math.min(e+1,c),h=Math.min(f,c);return b=b.slice(e,f),this.$element.trigger(a.Event("paginated.adcom.index",{page:this.currentPage,pages:d,count:c,items:b,start:g,end:h})),b},d.prototype.renderItem=function(b){var c=this,d=b,e=this.$items.indexOf(b),f=this.template(d),g=a(f);this.states[e]&&g.addClass(this.options.selectedClass);var h=void 0===g.data("field")?g.find("[data-field]"):g;return h.each(function(b,c){var e=a(c).attr("data-field"),f="function"!=typeof d[e]?d[e]:d[e]();a(c).html(String(f||""))}),g.data("adcom.index.item",d),g.data("adcom.index.idx",e),g.on("update.adcom.index",function(a){c.updateItemAtIndex(e,a.item)}),c.rendered[e]=g,g},d.prototype.updateItems=function(a){this.$element.empty(),this.states=[],this.rendered=[],this.$items=a},d.prototype.deleteItemAtIndex=function(a){this.$items.splice(a,1),this.states.splice(a,1),this.rendered.splice(a,1)},d.prototype.updateItemAtIndex=function(a,b){if(this.$items[a]=b,this.rendered[a]){var c=this.rendered[a],d=this.renderItem(b);c.replaceWith(d),this.rendered[a]=d}},d.prototype.destroy=function(){this.$element.off(".adcom.index").removeData("adcom.index"),this.$element.empty(),this.states=[],this.rendered=[]},d.prototype.toggleSort=function(b){var c=this;b.each(function(){var b=a(this),d=(a(b.data("target")),b.data("sort")),e=(b.data("states")||"ascending,descending").split(/,\s*/),f=(b.attr("class").match(/[\^\s]sort-(ascending|descending)/)||[])[1],g=e.indexOf(f),h=e[(g+1)%e.length];a('[data-sort][data-target="'+b.data("target")+'"]').removeClass("sort-ascending sort-descending"),"off"!==h&&b.addClass("sort-"+h),c.setSort(d,{ascending:!1,descending:!0,off:null}[h])})},d.prototype.toggleFilter=function(b){var c=this;b.each(function(){var b=a(this),d=a(b.data("target"));if(d[0]===c.$element[0]){var e=b.attr("data-filter"),f=b.is(":input")?b.val():b.attr("data-match");f||(f=void 0),c.setFilter(e,f)}})},a.fn.index=b,a.fn.index.Constructor=d,a.fn.index.noConflict=function(){return a.fn.index=old,this},a(document).on(d.EVENTS,'[data-toggle="select"]',function(d){var e=a(this).closest('[data-toggle="select"]'),f=(e.attr("data-trigger")||"click").split(" ");if(-1!=f.indexOf(d.type)){var g=c(e,"adcom.index.item"),h=c(e,"adcom.index");b.call(h,"toggle",g)}}),a(document).on("click.adcom.index.data-api","[data-sort]",function(){var c=a(this).closest("[data-sort]"),d=a(c.data("target"));b.call(d,"toggleSort",c),b.call(d,"show")}),a(document).on(d.EVENTS,"[data-filter]",function(c){var d=a(this).closest("[data-filter]"),e=a(d.data("target")),f=d.is(":input")?"change":"click",g=(d.attr("data-trigger")||f).split(" ");-1!=g.indexOf(c.type)&&(b.call(e,"toggleFilter",d),b.call(e,"show"))}),a(document).on("click.adcom.index.data-api","[data-page]",function(){var c=a(this).closest("[data-page]"),d=a(c.data("target"));b.call(d,"page",c.data("page")),b.call(d,"show")}),a('[data-control="index"]').index()}(jQuery),+function(a){"use strict";function b(c){var e=Array.prototype.slice.call(arguments,b.length);return this.each(function(){var b=a(this),f=b.data("adcom.form");"object"==typeof c&&c&&f&&(f=!1);var g=a.extend({},d.DEFAULTS,b.data(),f&&f.options,"object"==typeof c&&c);f||b.data("adcom.form",f=new d(this,g)),"string"==typeof c?f[c].apply(f,e):g.show&&f.show("string"===g.serialized?JSON.parse(g.serialized):g.serialized)})}function c(b,c){return a.makeArray(b).concat(a.makeArray(a(b).parents())).reduce(function(b,d){return b?b:a(d).data(c)?a(d):void 0},null)}var d=function(b,c){this.options=c,this.$element=a(b)};d.VERSION="0.1.0",d.DEFAULTS={show:!0,serialized:{}},d.prototype.show=function(b,c){this.$element.trigger(a.Event("show.adcom.form",{serialized:b})),this.data=b,this.$element[0].reset(),this.$element.deserialize(b),c=c||{},this.sourceElement=c.sourceElement,this.sourceData=c.sourceData,a(this.$element[0]).one("reset",a.proxy(function(){this.sourceElement=this.sourceData=null},this)),this.$element.trigger(a.Event("shown.adcom.form",{serialized:b}))},d.prototype.submit=function(){var b=this.serialize();a.extend(b,{relatedTarget:this.$element,sourceElement:this.sourceElement,sourceData:this.sourceData}),this.$element.trigger(a.Event("submitted.adcom.form",b))},d.prototype.serialize=function(){var a={},b=this.$element.find(":disabled").removeAttr("disabled"),c=this.$element.serializeArray();b.attr("disabled","disabled");for(var d in c)a[c[d].name]=""===c[d].value?null:c[d].value;return{object:a,array:c}},d.prototype.validate=function(){if(this.$element.trigger(a.Event("validate.adcom.form")),!this.$element[0].checkValidity()){var b=this.$element[0].find('input[type="submit"]');b[0]||this.$element.append(new_submit=a('<input style="display: none;" type="submit">')),a(b[0]||new_submit[0]).trigger("click"),this.$element.trigger(a.Event("validate.adcom.form",{isValid:!1}))}this.$element.trigger(a.Event("validate.adcom.form",{isValid:!0}))},d.prototype.destroy=function(){this.$element.off(".adcom.form").removeData("adcom.form")},a.fn.form=b,a.fn.form.Constructor=d,a.fn.form.noConflict=function(){return a.fn.form=old,this},a(document).on("click",'[data-toggle="form"]',function(){var d=a(this).closest('[data-toggle="form"]'),e=a(d.data("target")),f=d.data("source")||"serialized",g=c(d,f),h=g.data(f);e.form({show:!1}),b.call(e,"show",h,{sourceElement:g.clone(!0,!1),sourceData:h})}),a(document).on("submit",'form[data-control="form"]',function(b){b.preventDefault(),a(b.target).form("submit")})+function(a,b){function c(b){return b.map(function(){return this.elements?a.makeArray(this.elements):this}).filter(":input").get()}function d(c){var d,e={};return a.each(c,function(c,f){d=e[f.name],e[f.name]=d===b?f:a.isArray(d)?d.concat(f):[d,f]}),e}var e=Array.prototype.push,f=/^(?:radio|checkbox)$/i,g=/\+/g,h=/^(?:option|select-one|select-multiple)$/i,i=/^(?:button|color|date|datetime|datetime-local|email|hidden|month|number|password|range|reset|search|submit|tel|text|textarea|time|url|week)$/i;a.fn.deserialize=function(j,k){var l,m,n=c(this),o=[];if(!j||!n.length)return this;if(a.isArray(j))o=j;else if(a.isPlainObject(j)){var p,q;for(p in j)a.isArray(q=j[p])?e.apply(o,a.map(q,function(a){return{name:p,value:a}})):e.call(o,{name:p,value:q})}else if("string"==typeof j){var r;for(j=j.split("&"),l=0,m=j.length;m>l;l++)r=j[l].split("="),e.call(o,{name:decodeURIComponent(r[0]),value:decodeURIComponent(r[1].replace(g,"%20"))})}if(!(m=o.length))return this;var s,t,u,v,w,x,y,q,z=a.noop,A=a.noop,B={};for(k=k||{},n=d(n),a.isFunction(k)?A=k:(z=a.isFunction(k.change)?k.change:z,A=a.isFunction(k.complete)?k.complete:A),l=0;m>l;l++)if(s=o[l],w=s.name,q=s.value,(t=n[w])&&(y=(v=t.length)?t[0]:t,y=(y.type||y.nodeName).toLowerCase(),x=null,i.test(y)?(v&&(u=B[w],t=t[B[w]=u==b?0:++u]),z.call(t,t.value=q)):f.test(y)?x="checked":h.test(y)&&(x="selected"),x))for(v||(t=[t],v=1),u=0;v>u;u++)s=t[u],s.value==q&&z.call(s,(s[x]=!0)&&q);return A.call(this),this}}(jQuery),a('[data-control="form"]').form()}(jQuery),+function(a){"use strict";function b(d){var e=Array.prototype.slice.call(arguments,b.length);return this.each(function(){var b=a(this),f=b.data("adcom.state"),g=a.extend({},c.DEFAULTS,b.data(),"object"==typeof d&&d);f||b.data("adcom.state",f=new c(this,g)),"string"==typeof d&&f[d].apply(f,e)})}var c=function(b,c){this.options=c,this.$element=a(b),this.$location=this.$element[0].location,this.$history=this.$element[0].history,this.state=this.getLocationState(),this.initialState=this.options.initialState||this.state,this.isUpdating=!1,this.$history.replaceState(this.initialState,document.title,this.$location.pathname+this.$location.search),this.$element[0].onpopstate=a.proxy(this.onpopstate,this),this.options.triggerState&&(this.options.allowRepeats=!1,this.$element.on("updated.adcom.state",a.proxy(this.triggerState,this)),this.peek())};c.VERSION="0.1.0",c.EVENTS=a.map("scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave load resize scroll unload error keydown keypress keyup load resize scroll unload error blur focus focusin focusout change select submit".split(" "),function(a){return a+".adcom.state.data-api"}).join(" "),c.DEFAULTS={format:"humanize",initialState:null,allowRepeats:!0,triggerState:!1,path:!1,condense:{attr:"q"}},c.prototype.getLocationState=function(){return this.deserialize(this.$location.pathname+this.$location.search)},c.prototype.push=function(b,c){b="undefined"!=typeof b?b:{},c="undefined"!=typeof c?c:{},c.merge="undefined"!=typeof c.merge?c.merge:!0,c.allowRepeats=this.options.allowRepeats,c.action=c.action||"push",c.merge&&(b=a.extend(!0,{},this.state,b));var d=this.serialize(b);this.$element.trigger(a.Event("push.adcom.state",{state:b,options:c})),d!==this.serialize(this.state)?(this.$history[c.action+"State"](b,document.title,d),this.update(b,a.Event("push.adcom.state"))):c.allowRepeats&&this.update(b,a.Event("push.adcom.state")),this.$element.trigger(a.Event("pushed.adcom.state",{state:b,options:c}))},c.prototype.pop=function(){this.$history.back()},c.prototype.peek=function(){this.update(this.state,a.Event("peek.adcom.state"))},c.prototype.onpopstate=function(a){this.update(a.state,a)},c.prototype.update=function(b,c){this.$element.trigger(a.Event("update.adcom.state",{state:b,trigger:c})),this.state=b,this.$element.trigger(a.Event("updated.adcom.state",{state:b,trigger:c}))},c.prototype.serialize=function(b){b=a.extend({},b);var c="",d="";if(this.options.path){var c=this.options.path.base||"",e=this.options.path.attr;b[e]&&(c+=b[e]),delete b[e]}switch(this.options.format){case"humanize":var d=a.param(b);break;case"condense":if(b&&Object.keys(b).length>0)var d=this.options.condense.attr+"="+btoa(JSON.stringify(b))}return d.length>0&&(c+="?"+d),0==c.length&&(c="/"),c},c.prototype.deserialize=function(a){var b=a.split("?")[0],d=c.parseParams(a.split("?")[1]),e={};switch(this.options.format){case"humanize":e=d;break;case"condense":d[this.options.condense.attr]&&(e=JSON.parse(atob(d[this.options.condense.attr])))}if(this.options.path){var f=b.replace(this.options.path.base,"");f&&(e[this.options.path.attr]=f)}return e},c.prototype.triggerState=function(b){var c=function(b,d){var e=[].concat(["state"],b).join("-");a.each(d,function(d,f){if("object"==typeof f)c([].concat(b,[d]),f);else{var g=a('[data-toggle="state"]['+e+"-"+d+'="'+f+'"]');g.each(function(b,c){a(c).trigger(a(c).data("trigger")||"click")})}})};b.trigger&&"push.adcom.state"!==b.trigger.type&&c([],b.state)},c.parseParams=function(b){function c(b,d,e){if(d+="",-1!==d.indexOf(".")){var f=d.split("."),g=d.split(/\.(.+)?/)[1];b[f[0]]||(b[f[0]]={}),""!==g?c(b[f[0]],g,e):console.warn('parseParams :: empty property in key "'+d+'"')}else if(-1!==d.indexOf("[")){var f=d.split("[");d=f[0];var f=f[1].split("]"),h=f[0];""==h?(b||(b={}),b[d]&&a.isArray(b[d])||(b[d]=[]),b[d].push(e)):(b||(b={}),b[d]&&a.isArray(b[d])||(b[d]=[]),b[d][parseInt(h)]=e)}else b||(b={}),b[d]=e}var d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(/\+/g," "))};b+="",null===b.match(/\?/)&&(b="?"+b);var f,g={};if(b){if(-1!==b.indexOf("#")&&(b=b.substr(0,b.indexOf("#"))),-1===b.indexOf("?"))return{};if(b=b.substr(b.indexOf("?")+1,b.length),""==b)return{};for(;f=d.exec(b);){var h=e(f[1]),i=e(f[2]);c(g,h,i)}}return delete g[void 0],g},a.fn.state=b,a.fn.state.Constructor=c,a.fn.state.noConflict=function(){return a.fn.state=old,this},a(document).on(c.EVENTS,'[data-toggle="state"]',function(c){var d=a(this),e=(d.attr("data-trigger")||"click").split(" "),f="false"==d.attr("data-merge")?!1:!0,g=d.attr("data-action");if(-1!=e.indexOf(c.type)){var h=JSON.parse(d.attr("state")||"{}");0==Object.keys(h).length&&a.each(d[0].attributes,function(b,c){if(c.name.match(/^state-.+/)){var d=h,e=c.name.replace(/^state-/,"").split("-");a.each(e,function(a,b){a<e.length-2?d=d[b]:d[b]=c.value})}}),b.call(a(window),"push",h,{merge:f,action:g})}}),a(window).on("load",function(){a('[data-control="state"]').each(function(){var c=a(this),d=c.data();d.path=d.path||{},d.condense=d.condense||{},d.allowRepeats=0!=d.allowRepeats?!0:!1,d.pathAttr&&(d.path.attr=d.pathAttr),d.pathBase&&(d.path.base=d.pathBase),d.condenseattr&&(d.consense.attr=d.condenseattr),a.isEmptyObject(d.path)&&delete d.path,a.isEmptyObject(d.condense)&&delete d.condense,b.call(a(window),d)})})}(jQuery);